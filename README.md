# Лабораторная работа 2: Биометрическая идентификация с использованием RNN

## Описание

Лабораторная работа по распознаванию лиц с применением рекуррентных нейронных сетей (RNN/LSTM). Реализована система биометрической идентификации, которая обрабатывает изображения лиц как последовательности для классификации.

## Датасет

**LFW (Labeled Faces in the Wild)** - датасет для распознавания лиц:
- Более 13,000 изображений лиц
- Множество персон (зависит от параметра `min_faces_per_person`)
- Размер изображений: 50x37 пикселей (после изменения размера)
- Тип биометрии: Статическая (фотографии лиц)
- Источник: Автоматическая загрузка через sklearn.datasets

## Архитектура RNN

### Основные компоненты

1. **LSTM слои**:
   - LSTM-128 (return_sequences=True)
   - LSTM-64 (return_sequences=True)
   - LSTM-32 (return_sequences=False)

2. **Регуляризация**:
   - Dropout (0.2-0.3) после каждого LSTM слоя
   - Early Stopping (patience=10)
   - Learning Rate Reduction (factor=0.5, patience=5)

3. **Полносвязные слои**:
   - Dense-64 (ReLU)
   - Dense-N (Softmax, N = количество классов)

4. **Обработка данных**:
   - Изображение интерпретируется как последовательность строк пикселей
   - Форма входных данных: (samples, timesteps, features)
   - timesteps = количество строк в изображении (50)
   - features = количество пикселей в строке (37)

## Выполненные задания

### 1. Датасет по биометрии
- ✓ Загрузка датасета LFW (>13k фотографий)
- ✓ Нормализация данных в диапазон [0, 1]
- ✓ Преобразование в формат для RNN (sequences)

### 2. Разработка архитектуры RNN
- ✓ Многослойная LSTM архитектура (3 слоя)
- ✓ Dropout для предотвращения переобучения
- ✓ Softmax для многоклассовой классификации

### 3. Обучение модели
- ✓ 3.1 Процент тестирования: 30%
- ✓ 3.2 Процент обучения: 70%
- ✓ 3.3 График переобучения (Training vs Validation)
- ✓ Adam optimizer
- ✓ Categorical Crossentropy loss
- ✓ Early Stopping и ReduceLROnPlateau callbacks

### 4. Метрики качества
Реализованы все требуемые метрики:
- ✓ **Accuracy** (Точность)
- ✓ **Recall** (Полнота) - macro и weighted
- ✓ **F-мера** (F1-Score) - macro и weighted
- ✓ **TPR** (True Positive Rate)
- ✓ **FPR** (False Positive Rate)
- ✓ **TP, TN, FP, FN** (Confusion Matrix компоненты)
- ✓ **MSE** (Mean Squared Error)
- ✓ **MAE** (Mean Absolute Error, аналог MSA)
- ✓ **ROC-кривые** для каждого класса
- ✓ **Сравнение TPR и FPR** с ROC-кривой
- ✓ **AUC** (Area Under Curve) для каждого класса и средний

### 5. Тесты на реальных примерах
- ✓ Визуализация предсказаний на случайных примерах
- ✓ Отображение уверенности модели
- ✓ Цветовая индикация правильных/неправильных предсказаний

### 6. Выводы
- ✓ Подробный анализ результатов
- ✓ Оценка эффективности RNN для биометрии
- ✓ Анализ переобучения
- ✓ Сравнение TPR и FPR
- ✓ Рекомендации по улучшению

## Установка и запуск

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Запуск анализа

```bash
python3 rnn_biometric_recognition.py
```

**Примечание**: При первом запуске датасет LFW будет автоматически загружен (может занять несколько минут в зависимости от скорости интернета).

## Зависимости

- tensorflow >= 2.13.0
- keras >= 2.13.0
- numpy >= 1.23.0
- pandas >= 1.5.0
- matplotlib >= 3.6.0
- seaborn >= 0.12.0
- scikit-learn >= 1.2.0
- opencv-python >= 4.8.0
- Pillow >= 10.0.0

## Результаты

### Создаваемые файлы

1. **training_history.png** - Графики точности и потерь в процессе обучения
2. **confusion_matrix.png** - Матрица ошибок для всех классов
3. **roc_curves.png** - ROC-кривые для каждого класса и сравнение TPR/FPR
4. **test_examples.png** - Примеры работы модели на тестовых данных
5. **report.txt** - Полный отчет с анализом и выводами

### Типичные результаты

**Метрики** (зависят от конкретного запуска и параметров):
- Accuracy: 0.75-0.90
- F1-Score: 0.70-0.85
- Mean AUC: 0.85-0.95
- TPR: 0.75-0.90
- FPR: 0.05-0.15

**Характеристики обучения**:
- Время обучения: 10-30 минут (зависит от оборудования)
- Количество эпох: 20-50 (с Early Stopping)
- Размер модели: ~2-5 MB

## Структура проекта

```
lab2/
├── rnn_biometric_recognition.py   # Основной скрипт
├── requirements.txt               # Зависимости
├── README.md                      # Этот файл
├── data/                          # Директория с датасетом (создается автоматически)
├── training_history.png           # Графики обучения
├── confusion_matrix.png           # Матрица ошибок
├── roc_curves.png                 # ROC-кривые
├── test_examples.png              # Примеры тестирования
└── report.txt                     # Отчет с выводами
```

## Особенности реализации

### 1. Обработка изображений для RNN
Изображения обрабатываются как последовательности:
- Каждая строка пикселей = один временной шаг (timestep)
- Пиксели в строке = признаки (features)
- Это позволяет LSTM учитывать пространственные зависимости

### 2. Многоклассовая классификация
- One-hot encoding для меток классов
- Softmax активация на выходном слое
- Categorical Crossentropy loss

### 3. Предотвращение переобучения
- Dropout слои (0.2-0.3)
- Early Stopping (остановка при ухудшении val_loss)
- Learning Rate Reduction (уменьшение lr при плато)

### 4. Метрики для многоклассовой задачи
- Macro-averaging для сбалансированной оценки
- Weighted-averaging для учета дисбаланса классов
- One-vs-Rest подход для вычисления TP, TN, FP, FN

## Практическое применение

1. **Системы контроля доступа**
   - Биометрическая аутентификация
   - Верификация личности

2. **Безопасность**
   - Идентификация в видеонаблюдении
   - Пропускные системы

3. **Социальные сети**
   - Автоматическая маркировка фотографий
   - Поиск по изображениям

4. **Банковская сфера**
   - Биометрическая верификация клиентов
   - Предотвращение мошенничества

## Ограничения и рекомендации

### Текущие ограничения
- Требуется достаточно большой датасет для каждого класса
- Чувствительность к качеству и освещению изображений
- Вычислительная сложность RNN

### Рекомендации по улучшению
1. Использование гибридной CNN+RNN архитектуры
2. Применение аугментации данных
3. Attention механизмы для фокусировки на важных участках
4. Transfer Learning с предобученными моделями
5. Увеличение объема обучающих данных

## Автор

Выполнено в рамках лабораторной работы по глубокому обучению и нейронным сетям.

## Лицензия

Проект создан в образовательных целях.
