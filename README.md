# Лабораторная работа: Кластеризация датасета SDN

## Описание

Лабораторная работа по анализу датасета SDN (Software-Defined Networking) с применением различных методов кластеризации. В работе реализованы и сравнены методы K-means, K-means++ и агломеративной кластеризации с использованием различных метрик расстояния.

## Датасет

**dataset_sdn.csv** - датасет содержит данные о сетевом трафике в программно-конфигурируемых сетях:
- Размер: 104,345 записей
- Количество признаков: 23
- Типы данных: временные метки, IP-адреса, количество пакетов, байты, протоколы и другие метрики сетевого трафика
- Метки классов: бинарная классификация (0 - нормальный трафик, 1 - аномальный)

## Выполненные задания

### 1. Анализ датасета
- Загрузка и изучение структуры данных
- Статистический анализ признаков
- Обработка пропущенных значений
- Стандартизация данных

### 2. Определение оптимального количества кластеров
- Метод локтя (Elbow Method)
- Silhouette Score для разного K
- Рекомендуемое количество кластеров: **7**

### 3. Методы кластеризации

#### K-means (стандартный)
- Метрика: евклидово расстояние
- Silhouette Score: 0.1757
- Davies-Bouldin Index: 1.8127
- Calinski-Harabasz Score: 12152.85

#### K-means++
- Улучшенная инициализация центроидов
- Silhouette Score: 0.1742
- Davies-Bouldin Index: 1.5973
- Calinski-Harabasz Score: 13767.46

#### Агломеративная кластеризация

**С евклидовым расстоянием:**
- Silhouette Score: 0.1967
- Davies-Bouldin Index: 0.9534
- Calinski-Harabasz Score: 149.88

**С манхэттенским расстоянием:**
- Silhouette Score: 0.1552
- Davies-Bouldin Index: 1.2230
- Calinski-Harabasz Score: 301.02

**С расстоянием Чебышева:**
- Silhouette Score: 0.2078
- Davies-Bouldin Index: 0.9618
- Calinski-Harabasz Score: 190.50

### 4. Классификация

- **Бинарная классификация**: разделение на два класса (нормальный/аномальный трафик)
- **Многоклассовая классификация**: разделение на 7 кластеров с различными характеристиками трафика

### 5. Оценка качества

#### ROC и AUC кривые
- K-means: AUC = 0.4296
- K-means++: AUC = 0.4280
- Агломеративная (euclidean): AUC = 0.4750
- Агломеративная (manhattan): AUC = 0.5041
- Агломеративная (chebyshev): AUC = 0.4997

**Лучший метод по AUC**: Агломеративная кластеризация с манхэттенским расстоянием

**Лучший метод по Silhouette Score**: Агломеративная кластеризация с расстоянием Чебышева

## Структура проекта

```
lab1/
├── dataset_sdn.csv                    # Исходный датасет
├── clustering_analysis.py             # Основной скрипт анализа
├── requirements.txt                   # Зависимости Python
├── README.md                          # Описание проекта
├── conclusions.txt                    # Подробные выводы
├── optimal_clusters.png               # График определения оптимального K
├── clustering_visualization.png       # Визуализация кластеров
├── roc_auc_curves.png                # ROC кривые
└── methods_comparison.png            # Сравнение методов
```

## Установка и запуск

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Запуск анализа

```bash
python3 clustering_analysis.py
```

## Зависимости

- pandas >= 1.5.0
- numpy >= 1.23.0
- matplotlib >= 3.6.0
- seaborn >= 0.12.0
- scikit-learn >= 1.2.0
- scipy >= 1.9.0

## Результаты

### Визуализации

1. **optimal_clusters.png** - графики метода локтя и Silhouette Score для определения оптимального количества кластеров
2. **clustering_visualization.png** - визуализация результатов всех методов кластеризации в пространстве первых двух главных компонент (PCA)
3. **roc_auc_curves.png** - ROC кривые для оценки качества бинарной классификации каждым методом
4. **methods_comparison.png** - сравнительные графики всех метрик качества

### Основные выводы

1. **Характеристики датасета**:
   - Датасет содержит разнообразные паттерны сетевого трафика
   - Присутствуют как нормальный, так и аномальный трафик
   - Высокая размерность признаков требует предобработки

2. **Сравнение методов**:
   - K-means++ показывает более стабильные результаты по сравнению со стандартным K-means
   - Агломеративная кластеризация с расстоянием Чебышева имеет лучший Silhouette Score
   - Агломеративная кластеризация с манхэттенским расстоянием показывает лучший AUC

3. **Метрики расстояния**:
   - **Евклидово расстояние**: универсально, подходит для большинства задач
   - **Манхэттенское расстояние**: устойчивее к выбросам, лучше для ортогональных данных
   - **Расстояние Чебышева**: учитывает максимальное отклонение, полезно для экстремальных значений

4. **Практическое применение**:
   - Выявление аномального сетевого трафика
   - Обнаружение DDoS атак и других киберугроз
   - Оптимизация маршрутизации в SDN сетях
   - Мониторинг и прогнозирование нагрузки на сеть

## Автор

Выполнено в рамках лабораторной работы по машинному обучению.

## Лицензия

Проект создан в образовательных целях.