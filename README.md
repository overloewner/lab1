# Лабораторная работа: Кластеризация датасета SDN

## Описание

Лабораторная работа по анализу датасета SDN (Software-Defined Networking) с применением различных методов кластеризации. В работе реализованы и сравнены методы K-means, K-means++ и агломеративной кластеризации с использованием различных метрик расстояния.

## Датасет

**dataset_sdn.csv** - датасет содержит данные о сетевом трафике в программно-конфигурируемых сетях:
- Размер: 104,345 записей (после обработки: 96,907)
- Количество признаков: 23 (используется 19 числовых)
- Типы данных: временные метки, IP-адреса, количество пакетов, байты, протоколы и другие метрики сетевого трафика
- Метки классов: бинарная классификация (0 - нормальный трафик, 1 - аномальный)

## Выполненные задания

### 1. Анализ датасета
- Загрузка и изучение структуры данных
- Статистический анализ признаков
- Проверка меток и пропущенных значений

### 1.5. Дополнительная обработка данных
- Удаление дубликатов: 5,091 записей
- Фильтрация выбросов (3σ): 2,347 записей
- Удаление признаков с нулевой дисперсией
- Итоговый размер: 96,907 записей

### 2. Предобработка данных
- Обработка пропущенных значений и бесконечностей
- Стандартизация признаков (StandardScaler)
- Снижение размерности для визуализации (PCA)

### 3. Определение оптимального количества кластеров
- Метод локтя (Elbow Method)
- Silhouette Score для разного K
- **Используется K=2** для бинарной классификации

### 4. Методы кластеризации (K=2, бинарная классификация)

#### K-means (стандартный)
- Метрика: евклидово расстояние
- Silhouette Score: 0.1625
- Davies-Bouldin Index: 2.0692
- Calinski-Harabasz Score: 17767.25

#### K-means++
- Улучшенная инициализация центроидов
- Silhouette Score: 0.1625
- Davies-Bouldin Index: 2.0683
- Calinski-Harabasz Score: 17767.28

#### Агломеративная кластеризация

**С евклидовым расстоянием:**
- Silhouette Score: 0.7974
- Davies-Bouldin Index: 0.3050
- Calinski-Harabasz Score: 264.34

**С манхэттенским расстоянием:**
- Silhouette Score: 0.8084 ⭐
- Davies-Bouldin Index: 0.2978
- Calinski-Harabasz Score: 297.48

**С расстоянием Чебышева:**
- Silhouette Score: 0.7891
- Davies-Bouldin Index: 0.2736
- Calinski-Harabasz Score: 163.25

### 5. Классификация

- **Бинарная классификация**: разделение на два класса (нормальный/аномальный трафик)
- **Многоклассовая классификация**: 2 кластера с различными характеристиками трафика

### 6. Оценка качества

#### ROC и AUC кривые
- K-means: AUC = 0.2765
- K-means++: AUC = 0.7237 ⭐
- Агломеративная (euclidean): AUC = 0.5012
- Агломеративная (manhattan): AUC = 0.4992
- Агломеративная (chebyshev): AUC = 0.5011

**Лучший метод по AUC**: K-means++ (0.7237)

**Лучший метод по Silhouette Score**: Агломеративная кластеризация с манхэттенским расстоянием (0.8084)

## Структура проекта

```
lab1/
├── dataset_sdn.csv                    # Исходный датасет
├── clustering_analysis.py             # Основной скрипт анализа
├── requirements.txt                   # Зависимости Python
├── README.md                          # Описание проекта
├── conclusions.txt                    # Подробные выводы
├── optimal_clusters.png               # График определения оптимального K
├── clustering_visualization.png       # Визуализация кластеров
├── roc_auc_curves.png                # ROC кривые
└── methods_comparison.png            # Сравнение методов
```

## Установка и запуск

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Запуск анализа

```bash
python3 clustering_analysis.py
```

## Зависимости

- pandas >= 1.5.0
- numpy >= 1.23.0
- matplotlib >= 3.6.0
- seaborn >= 0.12.0
- scikit-learn >= 1.2.0
- scipy >= 1.9.0

## Результаты

### Визуализации

1. **optimal_clusters.png** - графики метода локтя и Silhouette Score для определения оптимального количества кластеров
2. **clustering_visualization.png** - визуализация результатов всех методов кластеризации в пространстве первых двух главных компонент (PCA)
3. **roc_auc_curves.png** - ROC кривые для оценки качества бинарной классификации каждым методом
4. **methods_comparison.png** - сравнительные графики всех метрик качества

### Основные выводы

1. **Характеристики датасета**:
   - Исходный датасет: 104,345 записей
   - После дополнительной обработки: 96,907 записей (удалено 7,438 дубликатов и выбросов)
   - Присутствуют как нормальный, так и аномальный трафик
   - Высокая размерность признаков требует предобработки

2. **Сравнение методов для бинарной классификации (K=2)**:
   - **K-means++** показывает отличный AUC = 0.7237, значительно лучше стандартного K-means (0.2765)
   - **Агломеративная кластеризация** демонстрирует превосходные показатели Silhouette Score (0.79-0.81)
   - Агломеративная кластеризация с манхэттенским расстоянием имеет лучший Silhouette Score (0.8084)
   - K-means++ имеет лучший AUC для бинарной классификации (0.7237)

3. **Метрики расстояния**:
   - **Евклидово расстояние**: универсально, подходит для большинства задач
   - **Манхэттенское расстояние**: устойчивее к выбросам, показывает лучшие результаты для агломеративной кластеризации
   - **Расстояние Чебышева**: учитывает максимальное отклонение, полезно для экстремальных значений

4. **Дополнительная обработка данных**:
   - Удаление дубликатов и выбросов значительно улучшает качество кластеризации
   - Фильтрация по правилу 3σ позволяет убрать аномальные значения
   - Очистка данных критична для получения качественных результатов

5. **Практическое применение**:
   - Выявление аномального сетевого трафика
   - Обнаружение DDoS атак и других киберугроз
   - Оптимизация маршрутизации в SDN сетях
   - Мониторинг и прогнозирование нагрузки на сеть

## Автор

Выполнено в рамках лабораторной работы по машинному обучению.

## Лицензия

Проект создан в образовательных целях.